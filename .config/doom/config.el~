(require 'package)
(setq package-enable-at-startup nil)

(add-to-list 'package-archives
             '("melpa" . "https://melpa.org/packages/"))
(package-initialize)

(setq doom-font  (font-spec :family "JetBrains Mono" :size 17))

(setq doom-theme 'doom-dracula)
(map! :leader
      :desc "Load new theme" "h t" #'counsel-load-theme)

(setq display-line-numbers-type t)

(map! :leader
      :desc "Org babel tangle" "m B" #'org-babel-tangle)
(after! org
  (setq org-directory "~/org/"
        org-default-notes-file (expand-file-name "notes.org" org-directory)
        org-ellipsis " ▼ "
        org-superstar-headline-bullets-list '("◉" "●" "○" "◆" "●" "○" "◆")
        org-superstar-itembullet-alist '((?+ . ?➤) (?- . ?✦)) ; changes +/- symbols in item lists
        org-log-done 'time
        org-hide-emphasis-markers t
        ;; ex. of org-link-abbrev-alist in action
        ;; [[arch-wiki:Name_of_Page][Description]]
        org-link-abbrev-alist    ; This overwrites the default Doom org-link-abbrev-list
        '(("brave" . "https://search.brave.com/?q=")
          ("arch-wiki" . "https://wiki.archlinux.org/index.php/")
          ("ddg" . "https://duckduckgo.com/?q=")
          ("wiki" . "https://en.wikipedia.org/wiki/"))
        org-table-convert-region-max-lines 20000
        org-todo-keywords        ; This overwrites the default Doom org-todo-keywords
        '((sequence
           "TODO(t)"           ; A task that is ready to be tackled
           "BLOG(b)"           ; Blog writing assignments
           "GYM(g)"            ; Things to accomplish at the gym
           "PROJ(p)"           ; A project that contains other tasks
           "VIDEO(v)"          ; Video assignments
           "WAIT(w)"           ; Something is holding up this task
           "|"                 ; The pipe necessary to separate "active" states and "inactive" states
           "DONE(d)"           ; Task has been completed
           "CANCELLED(c)" )))) ; Task has been cancelled

(use-package! org-auto-tangle
  :defer t
  :hook (org-mode . org-auto-tangle-mode)
  :config
  (setq org-auto-tangle-default t))

(defun dt/insert-auto-tangle-tag ()
  "Insert auto-tangle tag in a literate config."
  (interactive)
  (evil-org-open-below 1)
  (insert "#+auto_tangle: t ")
  (evil-force-normal-state))

(map! :leader
      :desc "Insert auto_tangle tag" "i a" #'dt/insert-auto-tangle-tag)

(setq org-journal-dir "~/org/journal/"
      org-journal-date-prefix "* "
      org-journal-time-prefix "** "
      org-journal-date-format "%B %d, %Y (%A) "
      org-journal-file-format "%Y-%m-%d.org")

(add-to-list 'load-path "~/org-sync")
(mapc 'load
      '("org-element" "os" "os-bb" "os-github" "os-rmine"))

(setq org-directory "~/org/")

(setq delete-by-moving-to-trash t
      trash-directory "~/.local/share/Trash/files/")

(xterm-mouse-mode 1)

(map! :leader
      :desc "Switch to perspective NAME"       "DEL" #'persp-switch
      :desc "Switch to buffer in perspective"  "," #'persp-switch-to-buffer
      :desc "Switch to next perspective"       "]" #'persp-next
      :desc "Switch to previous perspective"   "[" #'persp-prev
      :desc "Add a buffer current perspective" "+" #'persp-add-buffer
      :desc "Remove perspective by name"       "-" #'persp-remove-by-name)

(use-package hungry-delete
  :ensure t
  :defer t
  :config (global-hungry-delete-mode))

;;;;;;; (setq initial-buffer-choice "~/.config/doom/start.org")

;;(define-minor-mode start-mode
;;"Provide functions for custom start page."
;;:lighter " start"
;;:keymap (let ((map (make-sparse-keymap)))
;;        ;;(define-key map (kbd "M-z") 'eshell)
;;      (evil-define-key 'normal start-mode-map
;;      (kbd "1") '(lambda () (interactive) (find-file "~/.config/doom/config.org"))
;;    (kbd "2") '(lambda () (interactive) (find-file "~/.config/doom/init.el"))
;;  (kbd "3") '(lambda () (interactive) (find-file "~/.config/doom/packages.el"))
;;(kbd "4") '(lambda () (interactive) (find-file "~/.config/doom/eshell/aliases"))
;;          (kbd "5") '(lambda () (interactive) (find-file "~/.config/doom/eshell/profile")))
;;        map))

;;;;(add-hook 'start-mode-hook 'read-only-mode) ;; make start.org read-only; use 'SPC t r' to toggle off read-only.
;;;;(provide 'start-mode)
